<!DOCTYPE html>
 <html xmlns="http://www.w3.org/1999/xhtml"
 	xmlns:th="http://www.thymleaf.org"
 	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
 	layout:decorate="~{layout/LayoutIndex}">
 	
 <head>

 </head>
 <body layout:fragment="content">
     <header id="top" class="header">
         <div id="map" class="text-vertical-center">
     	<section id="contact" class="map" >
         <script type="text/javascript">
 			var map;
 			var marker; 
 			var infowindow;
 			function initMap() {
 				var posicao = {lat: -29.8991610, lng: -51.1504780};
 		        map = new google.maps.Map(document.getElementById('map'), {
 		          zoom: 16,
 		          center: posicao,
 		          scrollwheel: false
 		        });
 		       
 		        //array de markers com suas posicoes e contents
 		           
 		       
 		    	   
 	 		       addMarker({coords:{posicao},content:'<h1>teste</h1>'});
 		    	
 		         		
 			}
 			// function do marker
 			function addMarker(props){
 				 marker = new google.maps.Marker({
 	 		          position: props.coords,
 	 		          map: map
 	 		        });
 				 
 				// adicionando conteudo à infowindow
 	 		     if(props.content){
 	 		    	  infowindow = new google.maps.InfoWindow({
 			 		    content: props.content
 			 		  });
 			 		       marker.addListener('click', function() {
 			 		    	    infowindow.open(map, marker);
 			 		    	  });
 	 		     }
 				
 				 
 			}
 
 			function trocarPosicao(endereco, nome, telefones, cnpj) {
 				$.ajax({
 					method: 'GET', // Requisicao de dados pro google
 					url: 'https://maps.googleapis.com/maps/api/geocode/json?address=' + endereco
 				}).done(function (data) {
 					var lat = data.results[0].geometry.location.lat;
 					var lng = data.results[0].geometry.location.lng;
 					map.setCenter({lat: lat, lng: lng});
 					marker.setPosition({lat: lat, lng: lng});
 					map.setZoom(16);
 					var content = "<h3 class='janela'>" + "Empresa: "+nome + "<br> Endereço: " + endereco + "<br> CNPJ: "+cnpj+"</h3>";
 					for (var j = 0; j < telefones.length; j++) {
 	     				content += "<br> Contato: "+ telefones[j].numero;
 	     			}
 					infowindow.setContent(content);
 				});
 			}
 	  </script>
     <script async defer
       src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC2UcFQk_-Y9Jqysa_vLaAzW0zJk88xreo&callback=initMap">
     </script>
         </section>
         </div>
         </header>
  
      <!-- Lista -->
     <div class="container" >
     <h1>Lista de Empresas</h1>
      <table id="example" class="table table-striped table-bordered table-hover">
           <thead>
              <tr>
                 <th>Nome</th>
                 <th>Email</th>
                 <th>Endereco</th>
                 <th>Telefone</th>
                 <th>Ações</th>
             </tr>
         </thead>
         <tbody>
                       
            </tbody>
     </table>
     
     </div>
     <span th:text="${role}"></span>
     
 <!-- Datatable -->
     <script>
         $('#example').dataTable();
     </script>
     
 </body>
 </html>